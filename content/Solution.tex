aspects: correct, fault-tolerant, low-latency and scalable



\section{Design}
\subsection{Architecture}
separate clusters for ingest, streaming, processing and ui
decoupling of ingestion and processing with persistent event log in between has benefits
\begin{itemize}
	\item handle backpressure without data loss
	\item decouple ingest and processing -> other processing possible
	\item replay in case of failure because not ephemeral
\end{itemize}


\subsection{Event Schema}
common schema, serialized as protobuf for strong typing but still allow flexible payload with any
Serialization formats~\cite[chapter~4]{Kleppmann.2017}
show all definitions in appendix
for larger cases, should use central schema registry like supported by confluent


\subsection{Ingestion}
Extensible design with ingestors and processors
write to ingess topics


\subsection{Flink Jobs}
describe common functions (key selectors)
write to job topic

job design considerations:
\begin{itemize}
	\item large sliding window with short period requires lots of memory
	\item High allowed lateness increases time until records can be garbage collected
	\item Accumulation functions only need to store a single value instead of all like in process function (aggregate early)
	\item only send relevant data to downstream tasks since data needs to be serialized, transferred and duplicates (for windows and CEP)
	\item state size influences checkpointing time
	\item watermarking and late data based on statistics (expected delay)
	\item checkpointing frequency
	\item retention period
	\item parallelism vs core/n\_workers
	\item watermark frequency changes computation effort
	\item variable reuse if sequential (e.g. reuse output tuples instead of creating them for every record. what about downstream ops?)
	\item need to balance correctness, latency and cost through watermark boundedness, allowed lateness and computing resources
\end{itemize}






\section{Deployment}
\subsection{Infrastructure Considerations}
capacity planning: https://www.ververica.com/blog/how-to-size-your-apache-flink-cluster-general-guidelines


immutable infrastructure (keep short)
infrastructure as code

